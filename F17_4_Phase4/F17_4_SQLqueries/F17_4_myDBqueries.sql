-->(1)-->THIS QUERY RETURNS THE BUSIEST DEPARTMENT/THE DEPARTTMENT WITH MOST NUMBER OF PATIENTS 
SELECT * FROM (
    SELECT DEPARTMENT,COUNT(REG_FK_PID) AS TOTAL_PATIENTS
    FROM REGISTRATION_DETAILS
    GROUP BY DEPARTMENT
    ORDER BY TOTAL_PATIENTS DESC)
WHERE ROWNUM=1;


-->(2)-->THIS QUERY RETURNS THE DEPARTMENT BILLLING REPORT FOR 3 MONTHS FROM 01-JUN-2017 
SELECT RD.DEPARTMENT,SUM(DD.DIAGNOSIS_COST) AS TOTAL_DIAGNOSIS_REVENUE,SUM(PI.TREATMENT_COST) AS TOTAL_TREATMENT_REVENUE
FROM ((DIAGNOSIS_DETAILS DD FULL JOIN REGISTRATION_DETAILS RD ON DD.DIG_FK_PID=RD.REG_FK_PID) FULL JOIN PATIENT_INFO PI ON RD.REG_FK_PID=PI.PID) FULL JOIN TREATMENT_DETAILS TD 
ON TD.TD_FK_PID=PI.PID
WHERE TD.TREATMENT_DATE >= TRUNC(ADD_MONTHS('01-JUN-17',3))
GROUP BY RD.DEPARTMENT
ORDER BY TOTAL_DIAGNOSIS_REVENUE,TOTAL_TREATMENT_REVENUE;

-->(3)-->THIS QUERY RETURNS THE DEPARTMENT REPORTS TO SEE FOR THE UNDERACTIVE DEPARTMENTS
SELECT DEPARTMENT,COUNT(REG_FK_PID) AS PATIENT_VOLUME
    FROM REGISTRATION_DETAILS RD FULL JOIN TREATMENT_DETAILS TD ON RD.REG_FK_PID=TD.TD_FK_PID  
    WHERE TD.TREATMENT_DATE >= TRUNC(ADD_MONTHS('01-JUN-17',3))
    GROUP BY DEPARTMENT
    ORDER BY PATIENT_VOLUME;

-->(4)-->THIS QUERY RETURNS THE TOTAL REVENUE GENERATED BY EACH DOCTORS    
SELECT DI.FIRST_NAME,DI.LAST_NAME,SUM(DD.DIAGNOSIS_COST+PI.TREATMENT_COST) AS TOTAL_REVENUE
FROM (DIAGNOSIS_DETAILS DD FULL JOIN PATIENT_INFO PI ON PI.PID=DD.DIG_FK_PID) FULL JOIN DOCTOR_INFO DI ON DI.DOC_UNAME=PI.P_FK_DOC_UNAME 
GROUP BY DI.FIRST_NAME,DI.LAST_NAME
ORDER BY TOTAL_REVENUE DESC;

-->(5)-->THIS QUERY RETURNS THE NUMBER OF PATIENTS ATTENDED BY THE DOCTORS
SELECT DI.FIRST_NAME,DI.LAST_NAME,COUNT(TD.TD_FK_DOC_UNAME) AS NUM_OF_PATIENTS_ATTENDED
FROM DOCTOR_INFO DI FULL JOIN TREATMENT_DETAILS TD ON DI.DOC_UNAME=TD.TD_FK_DOC_UNAME
GROUP BY DI.FIRST_NAME,DI.LAST_NAME
ORDER BY NUM_OF_PATIENTS_ATTENDED DESC;

-->(6)-->THIS QUERY RETURNS THE NUMBER OF DAYS OF THE PATIENT STAY
SELECT FIRST_NAME,LAST_NAME,GENDER,PT_PHONE#,STREET,CITY,STATE,ZIP_CODE,SSN,PID,TREATMENT_NAME,TREATMENT_COST,PRESCRIPTION,ADMISSION_DATE,ADMISSION_TIME,DISCHARGE_DATE,DISCHARGE_TIME,P_FK_DOC_UNAME,P_FK_NRS_UNAME,P_FK_REC_UNAME,P_FK_ACC_UNAME,DISCHARGE_DATE-ADMISSION_DATE AS LENGTH_OF_STAY FROM PATIENT_INFO
WHERE ADMISSION_DATE<>DISCHARGE_DATE OR ADMISSION_DATE IS NOT NULL OR DISCHARGE_DATE IS NOT NULL;

-->(7)-->THIS QUERY RETURNS LIST OF PATIENT ADMISSION EVEN IF IT WAS FOR A FEW HOURS
SELECT * FROM PATIENT_INFO
WHERE ADMISSION_DATE IS NOT NULL;

-->(8)-->THIS QUERY RETURNS AVERAGE SALARY FOR DOCTORS SPECIALTY-WISE
SELECT SPECIALTY,AVG(SALARY) FROM DOCTOR_INFO
GROUP BY SPECIALTY;

-->(9)-->THIS QUERY RETURNS THE AVERAGE DOCTOR SALARY OF THE HOSPITAL
SELECT AVG(SALARY) FROM DOCTOR_INFO;

-->(10)-->THIS QUERY RETURNS THE PATIENT'S AVERAGE LENGTH OF STAY FOR EACH DEPARTMENT 
SELECT RD.DEPARTMENT,AVG(PI.DISCHARGE_DATE-PI.ADMISSION_DATE) AS AVERAGE_LENGTH_OF_STAY 
FROM REGISTRATION_DETAILS RD JOIN PATIENT_INFO PI ON RD.REG_FK_PID=PI.PID
WHERE ADMISSION_DATE IS NOT NULL
GROUP BY RD.DEPARTMENT;

-->(11)-->THIS QUERY RETURNS THE NUMBER OF PATIENTS THAT VISITED THE HOSPITAL BETWEEN 2017-08-01 AND 2017-10-01
SELECT COUNT(*) AS TOTAL_PATIENTS
FROM PATIENT_INFO
WHERE PID IN(
	SELECT PID
	FROM PATIENT_INFO
	WHERE ADMISSION_DATE BETWEEN TO_DATE('2017-08-01','YYYY-MM-DD') AND TO_DATE('2017-11-01','YYYY-MM-DD'));

-->(12)-->THIS QUERY RETURNS THE NUMBER OF PATIENTS ADMISSIONS FOR EACH DEPARTMENT
SELECT REG.DEPARTMENT AS DEPARTMENT,COUNT(*) AS TOTAL_PATIENTS
FROM REGISTRATION_DETAILS REG JOIN PATIENT_INFO PATIENTS
ON REG.REG_FK_PID = PATIENTS.PID AND REG.REG_FK_SSN = PATIENTS.SSN
GROUP BY REG.DEPARTMENT
HAVING COUNT(*) > 2;

-->(13)-->THIS QUERY RETURNS THE LIST OF PATIENTS WHO HAD INSURANCE TYPE SILVER OR BRONZE AND STILL HAD TO PAY FOR MEDICINE THAT COST > $50 
SELECT PTI.FIRST_NAME,PTI.LAST_NAME,PATID.INSURANCE_TYPE,PATID.INSURANCE_ID,MD.MED_NAME
FROM (PATIENT_INFO PTI JOIN PATIENT_INSURANCE_DETAILS PATID ON PTI.PID=PATID.PI_FK_PID) JOIN MEDICINE_DETAILS MD ON PTI.PID=MD.MED_FK_PID
WHERE MD.MED_COST > 50 AND PTI.PID IN (SELECT PATID.PI_FK_PID FROM PATIENT_INSURANCE_DETAILS
                                        WHERE PATID.INSURANCE_TYPE IN ('SILVER','BRONZE'));

-->(14)-->THIS QUERY RETURNS THE NURSES' SALARIES
SELECT FIRST_NAME, LAST_NAME, SPECIALTY, SALARY
FROM NURSE_INFO;                                 

-->(15)-->THIS QUERY RETURNS THE LIST OF PATIENTS WHO DO NOT HAVE AN INSURANCE 
SELECT PI.FIRST_NAME,PI.LAST_NAME,PI.GENDER,PI.SSN,PI.PID
FROM PATIENT_INFO PI LEFT OUTER JOIN PATIENT_INSURANCE_DETAILS PTID ON PI.SSN=PTID.PI_FK_SSN
WHERE NOT EXISTS (SELECT PI.PID FROM PATIENT_INFO 
                    INTERSECT 
                  SELECT PTID.PI_FK_PID FROM PATIENT_INSURANCE_DETAILS)
ORDER BY PI.SSN;

-->(16)-->THIS QUERY RETURNS THE DOCTOR NAME WHOSE PATIENT HAD THE HIGHEST TREATMENT COST 
SELECT DI.FIRST_NAME AS DOCTOR_FIRST_NAME, DI.LAST_NAME AS DOCTOR_LAST_NAME,PI.PID,PI.TREATMENT_COST
FROM DOCTOR_INFO DI JOIN PATIENT_INFO PI ON DI.DOC_UNAME=PI.P_FK_DOC_UNAME
WHERE PI.PID IN ( SELECT PID FROM PATIENT_INFO
                    WHERE TREATMENT_COST = (SELECT MAX(TREATMENT_COST) FROM PATIENT_INFO));
            